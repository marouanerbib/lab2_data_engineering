with apps as (
    select
        app_id,
        app_title,
        app_description,
        app_summary,
        app_installs_str,
        installs_clean,
        app_min_installs,
        app_real_installs,
        app_score,
        app_ratings,
        app_reviews,
        app_price,
        app_is_free,
        app_currency,
        app_is_on_sale,
        app_sale_time,
        app_original_price,
        app_sale_text,
        app_offers_iap,
        app_iap_price_range,
        developer_id,
        developer_name,
        category_id,
        category_name,
        app_icon_url,
        app_header_img_url,
        app_screenshots,
        app_video_url,
        app_video_img_url,
        app_content_rating,
        app_content_rating_desc,
        app_ad_supported,
        app_contains_ads,
        app_released_at,
        app_updated_at_timestamp,
        app_version,
        app_comments
    from {{ ref('stg_playstore_apps') }}
)

select
    {{ dbt_utils.generate_surrogate_key(['app_id']) }} as app_sk,
    app_id,
    app_title,
    app_description,
    app_summary,
    app_installs_str,
    installs_clean,
    app_min_installs,
    app_real_installs,
    app_score,
    app_ratings,
    app_reviews,
    app_price,
    app_is_free,
    app_currency,
    app_is_on_sale,
    app_sale_time,
    app_original_price,
    app_sale_text,
    app_offers_iap,
    app_iap_price_range,
    developer_id,
    developer_name,
    category_id,
    category_name,
    app_icon_url,
    app_header_img_url,
    app_screenshots,
    app_video_url,
    app_video_img_url,
    app_content_rating,
    app_content_rating_desc,
    app_ad_supported,
    app_contains_ads,
    app_released_at,
    app_updated_at_timestamp,
    app_version,
    app_comments
from apps
